<!doctype html>
<html id="myGNUFreeJS">
  <head>
    <base target="_self" />
    <meta name="myGNUFreeJS" content="Boilerplate Linux Template" />
    <style>
      a:link,
      a:visited {
        color: black !important;
        text-decoration: none !important;
        flex-flow: row wrap !important;
        grid-column: 1 !important;
        grid-row: 1 !important;
        align-content: flex-start !important;
        z-index: 0 !important;
        height: 100% !important;
        overflow: auto !important;
      }
      a:hover,
      a:active {
        color: pink !important;
        text-decoration: none !important;
      }
    </style>
  </head>
  <body>
    <nav>
      <a id="userClickedNext" href="#" onclick="nextFunc">Load</a>
      <a id="userClickedAgain" href="#" onclick="againFunc">Reload</a>
    </nav>
    <input
      class="datepicker menu-img z-depth-5 card-panel red scale-transition scale-out scale-in"
      id="prefDate"
      type="text"
    />
    <div id="template"></div>
  </body>
  <script></script>
  <script>
    parent.document.addEventListener(
      "DOMContentLoaded",
      google.script.run.myFileJS(),
    );
  </script>
  <script id="gold" type="text/javascript">
    parent.document.addEventListener(
      "DOMContentLoaded",
      google.script.run.myFileJS(),
    );
  </script>
  <script>
    function serverside(func, args) {
      return new Promise((resolve, reject) => {
        google.script.run
          .withSuccessHandler((result) => {
            resolve(result);
          })
          .withFailureHandler((error) => {
            console.log(error);
            console.log(document.getElementById("test").innerHTML);
            reject(error);
          })
          .runBoilerplate([func], [args]);
      });
    }
    var againCap = "";
    document.addEventListener("DOMContentLoaded", updateFunc);
    function updateFunc() {
      google.script.run.withSuccessHandler(htmNum).runBoilerplate("gsFiles");
      function htmNum(drop) {
        var rndNumDrop = Math.floor(Math.random() * Math.floor(drop.length));
        var rndFunc = drop[rndNumDrop];
        localStorage.setItem("gsSearch", rndFunc);
        againCap = rndFunc;
        console.log(rndFunc + "...");
        document.getElementById("template").innerHTML =
          "waiting for " + rndFunc + "...";
        google.script.run
          .withSuccessHandler(allCap)
          .withFailureHandler(error)
          .runBoilerplate(rndFunc);
        function allCap(droplet) {
          alert(rndFunc + "(" + droplet + ")");
          alert("droplet.length = " + droplet.length);
          if (typeof droplet === null) {
            return;
          }
          if (droplet.length === 99) {
            google.script.run
              .withSuccessHandler(doCap)
              .runBoilerplate("seoCapital", droplet);
            function doCap(myFile) {
              alert(rndFunc + "(" + myFile + ")");

              document.getElementById("template").innerHTML =
                JSON.stringify(myFile);
            }
          } else {
            alert(droplet.length + " is not the required length");

            serverside("getScriptUrl")
              .then((cChange) => {
                console.log(
                  typeof cChange + " with length = " + cChange.length,
                );
                if (cChange.length === 112) {
                  // console.log(cChange)
                  var linkFollow = document.createElement("a");
                  linkFollow.href = cChange + "?func=" + rndFunc;
                  linkFollow.id = "linkFOLLOW";
                  linkFollow.target = "_child";
                  document.body.appendChild(linkFollow);
                  document.getElementById("linkFOLLOW").click();
                  document.getElementById("linkFOLLOW").remove();
                } else {
                  var docWnd = document.getElementById("template");
                  docWnd.innerHTML = cChange;
                }
              })
              .catch((er) => {
                alert(rndFunc + " error(" + er + ")");
                console.log(er);
                document.getElementById("template").innerHTML =
                  JSON.stringify(er);
              });
          }
        }
        function error(er) {
          alert(rndFunc + " error(" + er + ")");
          serverside("getScriptUrl")
            .then((cChange) => {
              console.log(typeof cChange + " with length = " + cChange.length);
              if (cChange.length === 112) {
                // console.log(cChange)
                var linkFollow = document.createElement("a");
                linkFollow.href = cChange + "?func=" + rndFunc;
                linkFollow.id = "linkFOLLOW";
                linkFollow.target = "_child";
                document.body.appendChild(linkFollow);
                document.getElementById("linkFOLLOW").click();
                document.getElementById("linkFOLLOW").remove();
              } else {
                var docWnd = document.getElementById("template");
                docWnd.innerHTML = cChange;
              }
            })
            .catch((er) => {
              alert(rndFunc + " error(" + er + ")");
              console.log(er);
              document.getElementById("template").innerHTML =
                JSON.stringify(er);
            });
        }
      }
    }

    document
      .getElementById("userClickedNext")
      .addEventListener("click", nextFunc);
    function nextFunc() {
      google.script.run.withSuccessHandler(htmNum).runBoilerplate("gsFiles");
      function htmNum(drop) {
        var rndNumDrop = Math.floor(Math.random() * Math.floor(drop.length));
        var rndFunc = drop[rndNumDrop];
        localStorage.setItem("gsSearch", rndFunc);
        againCap = rndFunc;
        console.log(rndFunc + "...");
        document.getElementById("template").innerHTML =
          "waiting for " + rndFunc + "...";
        google.script.run
          .withSuccessHandler(allCap)
          .withFailureHandler(error)
          .runBoilerplate(rndFunc);
        function allCap(droplet) {
          alert(rndFunc + "(" + droplet + ")");
          alert("droplet.length = " + droplet.length);
          if (droplet.length === 99) {
            google.script.run
              .withSuccessHandler(doCap)
              .runBoilerplate("seoCapital", droplet);
            function doCap(myFile) {
              alert(rndFunc + "(" + myFile + ")");
              document.getElementById("template").innerHTML =
                JSON.stringify(myFile);
            }
          } else {
            alert(droplet.length + " is not the required length");

            serverside("getScriptUrl")
              .then((cChange) => {
                console.log(
                  typeof cChange + " with length = " + cChange.length,
                );
                if (cChange.length === 112) {
                  // console.log(cChange)
                  var linkFollow = document.createElement("a");
                  linkFollow.href = cChange + "?func=" + rndFunc;
                  linkFollow.id = "linkFOLLOW";
                  linkFollow.target = "_child";
                  document.body.appendChild(linkFollow);
                  document.getElementById("linkFOLLOW").click();
                  document.getElementById("linkFOLLOW").remove();
                } else {
                  var docWnd = document.getElementById("template");
                  docWnd.innerHTML = cChange;
                }
              })
              .catch((er) => {
                alert(rndFunc + " error(" + er + ")");
                console.log(er);
                document.getElementById("template").innerHTML =
                  JSON.stringify(er);
              });
          }
        }
        function error(er) {
          alert(rndFunc + " error(" + er + ")");
          serverside("getScriptUrl")
            .then((cChange) => {
              console.log(typeof cChange + " with length = " + cChange.length);
              if (cChange.length === 112) {
                // console.log(cChange)
                var linkFollow = document.createElement("a");
                linkFollow.href = cChange + "?func=" + rndFunc;
                linkFollow.id = "linkFOLLOW";
                linkFollow.target = "_child";
                document.body.appendChild(linkFollow);
                document.getElementById("linkFOLLOW").click();
                document.getElementById("linkFOLLOW").remove();
              } else {
                var docWnd = document.getElementById("template");
                docWnd.innerHTML = cChange;
              }
            })
            .catch((er) => {
              alert(rndFunc + " error(" + er + ")");
              console.log(er);
              document.getElementById("template").innerHTML =
                JSON.stringify(er);
            });
        }
      }
    }

    document
      .getElementById("userClickedAgain")
      .addEventListener("click", againFunc);
    function againFunc() {
      document.getElementById("template").innerHTML =
        "waiting for " + againCap + "...";
      google.script.run
        .withSuccessHandler(allCap)
        .withFailureHandler(error)
        .runBoilerplate(againCap);
      function allCap(droplet) {
        alert(againCap + "(" + droplet + ")");
        alert("droplet.length = " + droplet.length);
        if (droplet.length === 99) {
          google.script.run
            .withSuccessHandler(doCap)
            .runBoilerplate("seoCapital", droplet);
          function doCap(myFile) {
            alert(againCap + "(" + myFile + ")");
            document.getElementById("template").innerHTML =
              JSON.stringify(myFile);
          }
        } else {
          alert(droplet.length + " is not the required length");

          serverside("getScriptUrl")
            .then((cChange) => {
              console.log(typeof cChange + " with length = " + cChange.length);
              if (cChange.length === 112) {
                // console.log(cChange)
                var linkFollow = document.createElement("a");
                linkFollow.href = cChange + "?func=" + againCap;
                linkFollow.id = "linkFOLLOW";
                linkFollow.target = "_child";
                document.body.appendChild(linkFollow);
                document.getElementById("linkFOLLOW").click();
                document.getElementById("linkFOLLOW").remove();
              } else {
                var docWnd = document.getElementById("template");
                docWnd.innerHTML = cChange;
              }
            })
            .catch((er) => {
              alert(againCap + " error(" + er + ")");
              console.log(er);
              document.getElementById("template").innerHTML =
                JSON.stringify(er);
            });
        }
      }
      function error(er) {
        alert(againCap + " error(" + er + ")");
        serverside("getScriptUrl")
          .then((cChange) => {
            console.log(typeof cChange + " with length = " + cChange.length);
            if (cChange.length === 112) {
              // console.log(cChange)
              var linkFollow = document.createElement("a");
              linkFollow.href = cChange + "?func=" + againCap;
              linkFollow.id = "linkFOLLOW";
              linkFollow.target = "_child";
              document.body.appendChild(linkFollow);
              document.getElementById("linkFOLLOW").click();
              document.getElementById("linkFOLLOW").remove();
            } else {
              var docWnd = document.getElementById("template");
              docWnd.innerHTML = cChange;
            }
          })
          .catch((er) => {
            alert(rndFunc + " error(" + er + ")");
            console.log(er);
            document.getElementById("template").innerHTML = JSON.stringify(er);
          });
      }
    }
  </script>
</html>
