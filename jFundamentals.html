<!doctype html>
<html id="jFundamentals">
  <head>
    <base target="_self" />
    <meta
      name="jFundamentals"
      content="Boilerplate JavaScript Fundamental Course"
    />
    <style>
      a:link,
      a:visited {
        color: black !important;
        text-decoration: none !important;
        flex-flow: row wrap !important;
        grid-column: 1 !important;
        grid-row: 1 !important;
        align-content: flex-start !important;
        z-index: 0 !important;
        height: 100% !important;
        overflow: auto !important;
      }
      a:hover,
      a:active {
        color: pink !important;
        text-decoration: none !important;
      }
    </style>
  </head>
  <body>
    <nav>
      <a id="requestor" href="#" onclick="navAway()">Load</a>
      <a id="caller" href="#" onclick="updatePage()">Reload</a>
      <a
        href="https://www.blogger.com/blog/post/preview/2987570271158753052/1793164690968958582"
        target="_blank"
        >Blogger</a
      >
      <a href="https://www.aicinsuranceschools.com/" target="_top">CE</a>
    </nav>
    <br />
    <div id="drip">waiting...</div>
    <script id="jFundamentalsScript1">
      function serverside(func, args) {
        return new Promise((resolve, reject) => {
          google.script.run
            .withSuccessHandler((result) => {
              resolve(result);
            })
            .withFailureHandler((error) => {
              console.log(error);
              console.log(document.getElementById("test").innerHTML);
              reject(error);
            })
            .runBoilerplate([func], [args]);
        });
      }
      document.addEventListener("DOMContentLoaded", updatePage);
      var htmFileList = [
        `index proMedia callBack oddChances checkOnDay Section3.Challenge1`,
      ]
        .toString()
        .split(" ");
      var htmNum = function () {
        return Math.floor(Math.random() * Math.floor(htmFileList.length));
      };
      var rndPage = htmFileList[htmNum()];
      console.log(rndPage + "...");
      function updatePage() {
        localStorage.setItem("htmSearch", rndPage);
        document.getElementById("drip").innerHTML =
          "waiting for " + rndPage + "...";
        google.script.run
          .withSuccessHandler(done)
          .withFailureHandler(error)
          .runBoilerplate("renderFile", [rndPage]);
        function done(drop) {
          alert(rndPage + "(" + drop + ")");
          alert("droplet.length = " + drop.length);
          // alert(droplet.length + " is not the required length")

          serverside("getScriptUrl")
            .then((cChange) => {
              console.log(typeof cChange + " with length = " + cChange.length);
              if (cChange.length === 112) {
                // console.log(cChange)
                var linkFollow = document.createElement("a");
                linkFollow.href = cChange + "?func=renderFile&args=" + rndPage;
                linkFollow.id = "linkFOLLOW";
                linkFollow.target = "_child";
                document.body.appendChild(linkFollow);
                document.getElementById("linkFOLLOW").click();
                document.getElementById("linkFOLLOW").remove();
              } else {
                var docWnd = document.getElementById("drip");
                docWnd.innerHTML = drop;
              }
            })
            .catch((er) => {
              alert(rndPage + " error(" + er + ")");
              console.log(er);
              document.getElementById("drip").innerHTML = er;
            });
        }
      }
      function navAway() {
        var newPage = htmFileList[htmNum()];
        rndPage = newPage;
        localStorage.setItem("htmSearch", rndPage);
        document.getElementById("drip").innerHTML =
          "waiting for " + newPage + "...";
        google.script.run
          .withSuccessHandler(done)
          .withFailureHandler(error)
          .runBoilerplate("renderFile", [newPage]);
        function done(drop) {
          alert(rndPage + "(" + drop + ")");
          alert("droplet.length = " + drop.length);
          // alert(droplet.length + " is not the required length")

          serverside("getScriptUrl")
            .then((cChange) => {
              console.log(typeof cChange + " with length = " + cChange.length);
              if (cChange.length === 112) {
                // console.log(cChange)
                var linkFollow = document.createElement("a");
                linkFollow.href = cChange + "?func=renderFile&args=" + rndPage;
                linkFollow.id = "linkFOLLOW";
                linkFollow.target = "_child";
                document.body.appendChild(linkFollow);
                document.getElementById("linkFOLLOW").click();
                document.getElementById("linkFOLLOW").remove();
              } else {
                var docWnd = document.getElementById("drip");
                docWnd.innerHTML = drop;
              }
            })
            .catch((er) => {
              alert(rndPage + " error(" + er + ")");
              console.log(er);
              document.getElementById("drip").innerHTML = er;
            });
        }
      }
      function error(er) {
        alert(rndPage + " error(" + er + ")");
        console.log(er);
        document.getElementById("drip").innerHTML = er;
      }
    </script>
  </body>
</html>
